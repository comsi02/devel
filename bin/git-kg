#!/usr/bin/env perl
my $u="http://127.0.0.1:9000/flask/jira/info";
my $all;

if (defined $ARGV[0]) {
    if ($ARGV[0] eq "-a") {
		$all = "--all";
    }
    elsif($ARGV[0] eq "-h") {
        print "\n";
        print "\tUsage: \033[32m$0\033[0m [-h] [-a]\n";
        print "\t       \033[32m$0\033[0m -h (display help)\n";
        print "\t       \033[32m$0\033[0m -a (display remote branch)\n";
        exit;
    }
}

my $idx = 0;
my @git;
foreach(split /\n/, `git branch -v $all`) {
	$idx += 1;
	push @git, $_;
	if ($idx % 20 eq 0) {
		my $k = join "\n", @git;
		my $g = `echo "$k"|grep ''|base64|awk 'BEGIN{ORS="";} {print}'`;
		print `echo;curl $u --data-urlencode "branch=$g" 2>/dev/null;`;
		@git = ();
	}
}
my $k = join "\n", @git;
my $g = `echo "$k"|grep ''|base64|awk 'BEGIN{ORS="";} {print}'`;
print `echo;curl $u --data-urlencode "branch=$g" 2>/dev/null;`;
print `echo`

__END__
my $g=`git branch -v $all | grep '' | base64 | awk 'BEGIN{ORS="";} {print}'`;
print `echo;curl $u --data-urlencode "branch=$g" 2>/dev/null;echo;`;

